<section class="container my-5">
    <h1 class="text-center text-uppercase mb-4">Manage Orders</h1>
    <div class="table-responsive">
        <table class="table table-bordered align-middle">
            <thead class="table-light">
                <tr>
                    <th>#</th>
                    <th>User</th>
                    <th>Products</th>
                    <th>Total Price</th>
                    <th>Status</th>
                    <th>Ordered At</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <% if (orders.length> 0) { %>
                    <% orders.forEach((order, idx)=> { %>
                        <tr>
                            <td>
                                <%= idx + 1 %>
                            </td>
                            <td>
                                <%= order.user ? order.user.email : 'N/A' %>
                            </td>
                            <td>
                                <ul>
                                    <% order.products.forEach(item=> { %>
                                        <li>
                                            <%= item.product ? item.product.bookName : 'N/A' %> x <%= item.quantity %>
                                        </li>
                                        <% }) %>
                                </ul>
                            </td>
                            <td>$<%= order.totalPrice %>
                            </td>
                            <td>
                                <%= order.paymentStatus %>
                            </td>
                            <td>
                                <%= order.createdAt.toLocaleString() %>
                            </td>
                            <td>
                                <a href="/admin/orders/update/<%= order._id %>"
                                    class="btn btn-warning btn-sm">Update</a>
                                <a href="/admin/orders/delete/<%= order._id %>" class="btn btn-danger btn-sm"
                                    onclick="return confirm('Delete this order?');">Delete</a>
                            </td>
                        </tr>
                        <% }) %>
                            <% } else { %>
                                <tr>
                                    <td colspan="7" class="text-center">No orders found!</td>
                                </tr>
                                <% } %>
            </tbody>
        </table>
    </div>
</section>